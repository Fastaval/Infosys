import{_ as A,u as E,r as s,o as G,a as J,b as i,c as S,d as Q,e as l,f as o,w as p,g as W,h as X,F as Y,p as Z,i as ee}from"./index-9f808e14.js";import{g as te,a as oe,f as le,c as ae}from"./users.service-8aef62a1.js";const r=g=>(Z("data-v-dff98969"),g=g(),ee(),g),se={style:{display:"inline-flex",gap:"1rem"}},ne={style:{display:"inline-flex",gap:"0.5rem"}},ie=r(()=>l("label",{for:"showOnlyOpen"},"Åbne opgaver",-1)),re={style:{display:"inline-flex",gap:"0.5rem"}},de=r(()=>l("label",{for:"showOnlyMine"},"Mine opgaver",-1)),ue={class:"p-input-icon-left"},pe=r(()=>l("i",{class:"pi pi-search"},null,-1)),ce=r(()=>l("h4",null,"Opret opgave",-1)),ve={style:{display:"grid","grid-template-columns":"minmax(400px, 800px) minmax(150px, 300px)",gap:"1rem"}},me={style:{display:"flex","flex-direction":"column"}},fe=r(()=>l("label",{class:"help-text"},"Navn/Titel",-1)),ge=r(()=>l("label",{class:"help-text"},"Opgavebeskrivelse",-1)),_e={style:{display:"flex","flex-direction":"column","background-color":"#eee",padding:"1rem",height:"min-content","padding-bottom":"1.5rem","border-radius":"4px"}},ye=r(()=>l("label",{class:"help-text"},"Kategori",-1)),be=r(()=>l("label",{class:"help-text"},"Prioritet",-1)),we=r(()=>l("label",{class:"help-text"},"Udføres af",-1)),xe={style:{display:"inline-flex",gap:"1rem"}},ke={__name:"Tickets",setup(g){const D=E(),C=s(),b=s(),c=s(),I=s(),d=s(),v=s(!1),w=s(!0),x=s(!1),k=s(""),m=s(""),f=s(""),h=s(0),V=s(0),_=s(""),P=async()=>{await le().then(a=>{C.value=Object.values(a.tickets).map(e=>(e.category=d.value.tickets.category[e.category].da,e.priority=d.value.tickets.priority[e.priority].da,e.creator=c.value.find(n=>n.id===e.creator).name,e.assignee=c.value.find(n=>n.id===e.assignee).name,e.status=e.open===1?d.value.tickets.status.open[e.status].da:d.value.tickets.status.closed[e.status].da,e)),y()})},y=()=>b.value=C.value.filter(a=>M(a)&&N(a)&&R(a)),M=a=>a.name.toLowerCase().includes(k.value.toLowerCase())??!0,N=a=>w.value?a.open===1:!0,R=a=>x.value?a.assignee===I.value:!0,B=()=>{m.value="",f.value="",v.value=!0},$=async()=>{await ae({name:m.value,description:f.value,priority:h.value,category:V.value,assignee:_.value}).then(async()=>{await P(),v.value=!1})},F=()=>!m.value||!f.value||!_.value,z=a=>{const e=a.data.id;D.push({path:`tickets/show/${e}`})};return G(async()=>{d.value=await te(),c.value=Object.values(await oe()),await P()}),J(async()=>{var a;I.value=(a=c.value.find(e=>{var n;return e.id===((n=window==null?void 0:window.infosys)==null?void 0:n.user_id)}))==null?void 0:a.name}),(a,e)=>{const n=i("Button"),U=i("InputSwitch"),L=i("InputText"),K=i("Toolbar"),u=i("Column"),j=i("DataTable"),q=i("Textarea"),T=i("Dropdown"),H=i("Dialog");return S(),Q(Y,null,[l("div",null,[o(n,{icon:"pi pi-plus",size:"small",raised:"",onClick:e[0]||(e[0]=t=>B()),label:"Opret"})]),o(K,null,{start:p(()=>[l("div",se,[l("div",ne,[o(U,{inputId:"showOnlyOpen",modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=t=>w.value=t),onChange:e[2]||(e[2]=t=>y())},null,8,["modelValue"]),ie]),l("div",re,[o(U,{inputId:"showOnlyMine",modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=t=>x.value=t),onChange:e[4]||(e[4]=t=>y())},null,8,["modelValue"]),de])])]),end:p(()=>[l("span",ue,[pe,o(L,{class:"search-field",modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=t=>k.value=t),modelModifiers:{trim:!0},onKeyup:e[6]||(e[6]=t=>y()),placeholder:"Søg i opgaver"},null,8,["modelValue"])])]),_:1}),b.value?(S(),W(j,{key:0,value:b.value,rows:10,rowsPerPageOptions:[5,10,20,50,100],rowHover:!0,onRowClick:z,paginator:"",paginatorTemplate:" FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"{first}-{last} ud af {totalRecords}",stripedRows:"",removableSort:"",size:"small"},{default:p(()=>[o(u,{field:"id",header:"ID",sortable:""}),o(u,{field:"category",header:"Kategori",sortable:""}),o(u,{field:"name",header:"Navn",sortable:""}),o(u,{field:"priority",header:"Prioritet",sortable:""}),o(u,{field:"creator",header:"Opretter",sortable:""}),o(u,{field:"assignee",header:"Udfører",sortable:""}),o(u,{field:"status",header:"Status",sortable:""})]),_:1},8,["value"])):X("",!0),o(H,{visible:v.value,"onUpdate:visible":e[14]||(e[14]=t=>v.value=t),modal:"",class:"newTicket"},{header:p(()=>[ce]),footer:p(()=>[l("div",xe,[o(n,{severity:"info",text:"",label:"Luk",icon:"pi pi-times",onClick:e[12]||(e[12]=t=>v.value=!1)}),o(n,{label:"Opret opgave",raised:"",disabled:F(),onClick:e[13]||(e[13]=t=>$())},null,8,["disabled"])])]),default:p(()=>[l("div",ve,[l("div",me,[fe,o(L,{modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=t=>m.value=t),modelModifiers:{trim:!0},required:"",style:{width:"400px"}},null,8,["modelValue"]),ge,o(q,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=t=>f.value=t),modelModifiers:{trim:!0},autoResize:!0,rows:10,style:{width:"100%"},required:""},null,8,["modelValue"])]),l("div",_e,[ye,o(T,{modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=t=>V.value=t),options:d.value.tickets.category.map((t,O)=>({label:t.da,value:O})),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),be,o(T,{modelValue:h.value,"onUpdate:modelValue":e[10]||(e[10]=t=>h.value=t),options:d.value.tickets.priority.map((t,O)=>({label:t.da,value:O})),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),we,o(T,{modelValue:_.value,"onUpdate:modelValue":e[11]||(e[11]=t=>_.value=t),options:c.value,resetFilterOnHide:!0,optionLabel:"name",optionValue:"id",filter:""},null,8,["modelValue","options"])])])]),_:1},8,["visible"])],64)}}},Te=A(ke,[["__scopeId","data-v-dff98969"]]);export{Te as default};
